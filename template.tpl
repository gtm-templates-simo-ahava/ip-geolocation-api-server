___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "CLIENT",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "__wm": "VGVtcGxhdGUtQXV0aG9yX0lQR2VvbG9jYXRpb25BUElTZXJ2ZXItU2ltby1BaGF2YQ==",
  "category": ["UTILITY"],
  "displayName": "IP & Geolocation API",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QCmRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgE7AAIAAAAZAAAAWodpAAQAAAABAAAAdAAAAAAAAABIAAAAAQAAAEgAAAABVmVjdG9yU3RvY2suY29tLzEyMDA2Njc3AAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAZKADAAQAAAABAAAAZAAAAAD/4Qm5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+IDxkYzpjcmVhdG9yPiA8cmRmOlNlcT4gPHJkZjpsaT5WZWN0b3JTdG9jay5jb20vMTIwMDY2Nzc8L3JkZjpsaT4gPC9yZGY6U2VxPiA8L2RjOmNyZWF0b3I+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9InciPz4A/+0AZFBob3Rvc2hvcCAzLjAAOEJJ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\u003d\u003d"
  },
  "description": "An API endpoint that returns the user\u0027s IP together with geolocation data collected from App Engine\u0027s headers.",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "LABEL",
    "name": "label1",
    "displayName": "To use the API, perform an HTTP POST request to the \u003cstrong\u003e/geo/\u003c/strong\u003e endpoint of the server-side endpoint. The response will include a JSON object that has the user\u0027s IP address as well as any geolocation information derived from App Engine\u0027s request headers."
  },
  {
    "type": "RADIO",
    "name": "allowedOrigins",
    "displayName": "Allowed origins",
    "radioItems": [
      {
        "value": "all",
        "displayValue": "All origins"
      },
      {
        "value": "notall",
        "displayValue": "Specific origins"
      }
    ],
    "simpleValueType": true,
    "help": "Choose whether to accept API calls from all origins or only from specific origins. If you choose the latter, you will need to add each origin (e.g. \u003cstrong\u003ehttps://mydomain.com\u003c/strong\u003e) as a separate row to the table."
  },
  {
    "type": "SIMPLE_TABLE",
    "name": "originList",
    "simpleTableColumns": [
      {
        "defaultValue": "",
        "displayName": "Origin",
        "name": "origin",
        "type": "TEXT",
        "valueHint": "https://www.domain.com"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "allowedOrigins",
        "paramValue": "notall",
        "type": "EQUALS"
      }
    ],
    "newRowButtonText": "Add origin"
  }
]


___SANDBOXED_JS_FOR_SERVER___

const claimRequest = require('claimRequest');
const getRemoteAddress = require('getRemoteAddress');
const getRequestHeader = require('getRequestHeader');
const getRequestMethod = require('getRequestMethod');
const getRequestPath = require('getRequestPath');
const JSON = require('JSON');
const log = require('logToConsole');
const returnResponse = require('returnResponse');
const setResponseHeader = require('setResponseHeader');
const setResponseBody = require('setResponseBody');
const setResponseStatus = require('setResponseStatus');

const API_PATH = '/geo/';

const fail = msg => {
  setResponseStatus(500);
  setResponseBody(msg);
  returnResponse();
};

const setAccessHeaders = () => {
  if (data.allowedOrigins === 'all') {
    setResponseHeader('Access-Control-Allow-Origin', getRequestHeader('origin'));
  } else {
    data.originList.forEach(row => {
      setResponseHeader('Access-Control-Allow-Origin', row.origin);
    });
  }
  setResponseHeader('Access-Control-Allow-Credentials', 'true');
};

if (getRequestPath() === API_PATH) {
  claimRequest();
  
  setAccessHeaders();
  
  if (getRequestMethod() !== 'POST') {
    return fail('Invalid method: Must be POST');
  }
  
  const responseData = {
    user_ip: getRemoteAddress(),
    geo: {
      city: getRequestHeader('X-Appengine-City'),
      city_lat_long: getRequestHeader('X-Appengine-Citylatlong'),
      country: getRequestHeader('X-Appengine-Country'),
      region: getRequestHeader('X-Appengine-Region')
    }
  };
  
  setResponseStatus(200);
  setResponseBody(JSON.stringify(responseData));
  returnResponse();
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "headerWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "origin"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "forwarded"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "x-forwarded-for"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "x-appengine-city"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "x-appengine-citylatlong"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "x-appengine-country"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "x-appengine-region"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "remoteAddressAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "headersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "pathAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "return_response",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_response",
        "versionId": "1"
      },
      "param": [
        {
          "key": "writeResponseAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "writeStatusAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "writeHeaderAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "writeBodyAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "writeHeadersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "writeHeaderWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Access-Control-Allow-Origin"
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Access-Control-Allow-Credentials"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 11/02/2021, 15:09:07


